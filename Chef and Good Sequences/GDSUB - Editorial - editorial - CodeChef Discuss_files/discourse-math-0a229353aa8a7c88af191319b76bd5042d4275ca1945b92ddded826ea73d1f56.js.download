define("discourse/plugins/discourse-math/initializers/discourse-math-katex",["exports","discourse/lib/plugin-api","discourse/lib/load-script"],function(e,i,a){"use strict";function s(e){var t;e&&e.find&&(0<(t=e.find(".math")).length&&(0,a.default)("/plugins/discourse-math/katex/katex.min.js").then(function(){return(0,a.default)("/plugins/discourse-math/katex/katex.min.css",{css:!0}).then(function(){return(0,a.default)("/plugins/discourse-math/katex/mhchem.min.js")})}).then(function(){t.each(function(e,t){return i=t,s=$(i),n="DIV"===i.tagName,void(s.data("applied-katex")||(s.data("applied-katex",!0),s.hasClass("math")&&(a=s.text(),s.text(""),window.katex.render(a,i,{displayMode:n}))));var i,a,s,n})}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"apply-math-katex",initialize:function(e){var t=e.lookup("site-settings:main");t.discourse_math_enabled&&"katex"===t.discourse_math_provider&&(0,i.withPluginApi)("0.5",function(e){e.decorateCooked(function(e){s(e)},{id:"katex"})})}}}),define("discourse/plugins/discourse-math/initializers/discourse-math-mathjax",["exports","discourse/lib/plugin-api","discourse/lib/load-script"],function(e,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=!1;function r(e){var t,i,a;return t=e,n||(i=["toMathML.js","Safe.js"],t.enable_accessibility&&i.push("[a11y]/accessibility-menu.js"),a={jax:["input/TeX","input/AsciiMath","input/MathML","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","autoload-all.js"]},extensions:i,showProcessingMessages:!1,root:Discourse.getURLWithCDN("/plugins/discourse-math/mathjax")},t.zoom_on_hover&&(a.menuSettings={zoom:"Hover"},a.MathEvents={hover:750}),window.MathJax=a,n=!0),(0,s.default)("/plugins/discourse-math/mathjax/MathJax.2.7.5.js")}function o(e,t){var i,a;e&&e.find&&(a=void 0,0<(a=t.enable_asciimath?e.find(".math, .asciimath"):e.find(".math")).length&&(i=e.hasClass("d-editor-preview"),r(t).then(function(){a.each(function(e,t){return function(e,t){var i,a,s,n=$(e);n.data("applied-mathjax")||(n.data("applied-mathjax",!0),s=a=void 0,n.hasClass("math")?(i="DIV"===e.tagName?"div":"span",a=$("<"+i+' style="display: none;"><script type="math/tex'+("div"==i?"; mode=display":"")+'"><\/script></'+i+">"),(s=a.children()).text(n.text()),n.after(a)):n.hasClass("asciimath")&&(a=$('<span style="display: none;"><script type="math/asciimath"><\/script></span>'),(s=a.children()).text(n.text()),n.after(a)),Ember.run.later(this,function(){window.MathJax.Hub.Queue(function(){e.parentElement&&null!==e.parentElement.offsetParent&&window.MathJax.Hub.Typeset(s[0],function(){n.remove(),a.show()})})},t?200:0))}(t,i)})})))}e.default={name:"apply-math-mathjax",initialize:function(e){var t=e.lookup("site-settings:main"),i={zoom_on_hover:t.discourse_math_zoom_on_hover,enable_accessibility:t.discourse_math_enable_accessibility,enable_asciimath:t.discourse_math_enable_asciimath};t.discourse_math_enabled&&"mathjax"===t.discourse_math_provider&&(0,a.withPluginApi)("0.5",function(e){var t;t=i,e.decorateCooked(function(e){o(e,t)},{id:"mathjax"})})}}}),define("discourse/plugins/discourse-math/lib/discourse-markdown/discourse-math",["exports"],function(e){"use strict";function l(e,t,i){return e!==t&&(i.utils.isWhiteSpace(e)||(i.utils.isMdAsciiPunct(e)||!!i.utils.isPunctChar(e)))}function i(e,t,i){var a=e.pos,s=e.posMax;if(t||e.src.charCodeAt(a)!==i||s<a+2)return!1;if(e.src.charCodeAt(a+1)===i)return!1;if(0<a&&!l(e.src.charCodeAt(a-1),i,e.md))return!1;for(var n=void 0,r=a+1;r<s;r++){if(e.src.charCodeAt(r)===i&&92!==e.src.charCodeAt(r-1)){n=r;break}}if(!n)return!1;if(n+1<=s){var o=e.src.charCodeAt(n+1);if(o&&!l(o,i,e.md))return!1}var u=e.src.slice(a+1,n),c=e.push("html_raw","",0),d=e.md.utils.escapeHtml(u),h=36===i?"'math'":"'asciimath'";return c.content="<span class="+h+">"+d+"</span>",e.pos=n+1,!0}function t(e,t){return i(e,t,36)}function a(e,t){return i(e,t,37)}function d(e,t,i,a){if(36===e.src.charCodeAt(t)&&(t++,36===e.src.charCodeAt(t))){for(var s=++t;s<i;s++)if(!a.utils.isSpace(e.src.charCodeAt(s)))return;return 1}}function s(e,t,i,a){if(!d(e,e.bMarks[t]+e.tShift[t],e.eMarks[t],e.md))return!1;if(a)return!0;for(var s=t,n=!1;!(i<=++s);)if(d(e,e.bMarks[s]+e.tShift[s],e.eMarks[s],e.md)){n=!0;break}var r=e.push("html_raw","",0),o=n?e.eMarks[s-1]:e.eMarks[s],u=e.src.slice(e.bMarks[t+1]+e.tShift[t+1],o),c=e.md.utils.escapeHtml(u);return r.content="<div class='math'>\n"+c+"\n</div>\n",e.line=n?s+1:s,!0}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){if(!e.markdownIt)return;var i=void 0;e.registerOptions(function(e,t){e.features.math=t.discourse_math_enabled,i=t.discourse_math_enable_asciimath}),e.registerPlugin(function(e){i&&e.inline.ruler.after("escape","asciimath",a),e.inline.ruler.after("escape","math",t),e.block.ruler.after("code","math",s,{alt:["paragraph","reference","blockquote","list"]})})}});
//# sourceMappingURL=/assets/plugins/discourse-math-0a229353aa8a7c88af191319b76bd5042d4275ca1945b92ddded826ea73d1f56.js.map